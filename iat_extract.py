import pefile


def main(binary_path):
    pe = pefile.PE(binary_path)
    pe.parse_data_directories()
    for i in pe.DIRECTORY_ENTRY_IMPORT:
        print i.dll
        for j in i.imports:
            print '\t', j.name
    #for exp in pe.DIRECTORY_ENTRY_EXPORT.symbols:
        #print hex(pe.OPTIONAL_HEADER.ImageBase + exp.address), exp.name, exp.ordinal

if __name__ == '__main__':
    main('./benign/test.exe')

